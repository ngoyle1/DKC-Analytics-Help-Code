library(ggplot2)
install.packages(plotly)
install.packages("plotly")
library(plotly)
library(plotly)
set.seed(100)
d <- diamonds[sample(nrow(diamonds), 1000), ]
plot_ly(d, x = carat, y = price, text = paste("Clarity: ", clarity),
mode = "markers", color = carat, size = carat)
plot_ly(z = volcano, type = "surface")
setwd("Desktop/doctors_honest/")
remove(list = ls())
options(scipen = 999)
options(stringsAsFactors = FALSE)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
my_cities <- read_excel("list_of_cities_states.xlsx", sheet = 1)
my_cities$City <- tolower(my_cities$City)
##Get county and city counts##
get_county_city <- function(csv_file){
##Make sure the city, county file is loaded as my_cities
suppressWarnings(suppressMessages(library(sqldf)))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
first <- read.csv(csv_file, header = TRUE)
first$primary_city <- trim(tolower(first$primary_city))
filter_first <- first[first$primary_city %in% unique(my_cities$City),]
cities_sum <- sqldf("SELECT filter_first.primary_city,my_cities.State,my_cities.County,
COUNT(*) FROM filter_first LEFT JOIN my_cities ON filter_first.primary_city = my_cities.City
AND filter_first.primary_state = my_cities.State
GROUP BY 1,2,3
ORDER BY 4 DESC")
}
v <- get_county_city("doctors_honest.csv")
remove(list = ls())
options(scipen = 999)
options(stringsAsFactors = FALSE)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
my_cities <- read_excel("list_of_cities_states.xlsx", sheet = 1)
my_cities$City <- tolower(my_cities$City)
##Get county and city counts##
get_county_city <- function(csv_file){
##Make sure the city, county file is loaded as my_cities
suppressWarnings(suppressMessages(library(sqldf)))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
first <- read.csv(csv_file, header = TRUE)
first$primary_city <- trim(tolower(first$primary_city))
filter_first <- first[first$primary_city %in% unique(my_cities$City),]
cities_sum <- sqldf("SELECT filter_first.primary_city,my_cities.State,my_cities.County,
COUNT(*) FROM filter_first LEFT JOIN my_cities ON filter_first.primary_city = my_cities.City
AND filter_first.primary_state = my_cities.State
GROUP BY 1,2,3
ORDER BY 4 DESC")
}
v <- get_county_city("doctors_honest.csv")
remove(list = ls())
options(scipen = 999)
options(stringsAsFactors = FALSE)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
my_cities <- read_excel("list_of_cities_states.xlsx", sheet = 1)
my_cities$City <- tolower(my_cities$City)
remove(list = ls())
options(scipen = 999)
options(stringsAsFactors = FALSE)
library(readxl)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
my_cities <- read_excel("list_of_cities_states.xlsx", sheet = 1)
my_cities$City <- tolower(my_cities$City)
##Get county and city counts##
get_county_city <- function(csv_file){
##Make sure the city, county file is loaded as my_cities
suppressWarnings(suppressMessages(library(sqldf)))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
first <- read.csv(csv_file, header = TRUE)
first$primary_city <- trim(tolower(first$primary_city))
filter_first <- first[first$primary_city %in% unique(my_cities$City),]
cities_sum <- sqldf("SELECT filter_first.primary_city,my_cities.State,my_cities.County,
COUNT(*) FROM filter_first LEFT JOIN my_cities ON filter_first.primary_city = my_cities.City
AND filter_first.primary_state = my_cities.State
GROUP BY 1,2,3
ORDER BY 4 DESC")
}
v <- get_county_city("doctors_honest.csv")
View(v)
colnames(v)
remove(list = ls())
options(scipen = 999)
options(stringsAsFactors = FALSE)
library(readxl)
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
my_cities <- read_excel("list_of_cities_states.xlsx", sheet = 1)
my_cities$City <- tolower(my_cities$City)
##Get county and city counts##
get_county_city <- function(csv_file){
##Make sure the city, county file is loaded as my_cities
suppressWarnings(suppressMessages(library(sqldf)))
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
first <- read.csv(csv_file, header = TRUE)
first$primary_city <- trim(tolower(first$primary_city))
filter_first <- first[first$primary_city %in% unique(my_cities$City),]
cities_sum <- sqldf("SELECT filter_first.primary_city,my_cities.State,my_cities.County,
COUNT(*) FROM filter_first LEFT JOIN my_cities ON filter_first.primary_city = my_cities.City
AND filter_first.primary_state = my_cities.State
GROUP BY 1,2,3
ORDER BY 4 DESC")
}
v <- get_county_city("doctors_honest.csv")
colnames(v) <- c("city","state", "county", "number")
View(v)
write.csv(v, "doctor_geo_counts.csv", row.names = FALSE)
